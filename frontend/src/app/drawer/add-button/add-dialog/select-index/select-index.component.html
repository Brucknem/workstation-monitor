<mat-card>
  <mat-card-header>
    <mat-card-title>Select Devices</mat-card-title>
    <mat-card-subtitle
      >Select the devices for which to display data.</mat-card-subtitle
    >
  </mat-card-header>
  <mat-card-content>
    <ng-container *ngIf="indices">
      <div>
        <mat-selection-list #deviceSelect [multiple]="false">
          <mat-list-option
            *ngFor="let value of indices | keyvalue"
            [value]="value.key"
          >
            {{ value.key }}
          </mat-list-option>
        </mat-selection-list>
      </div>
      <div *ngIf="deviceSelect.selectedOptions.selected[0]">
        <hr />
        <mat-form-field appearance="fill">
          <mat-label>{{
            deviceSelect.selectedOptions.selected[0]?.value
          }}</mat-label>
          <mat-select
            multiple
            (selectionChange)="devicesSelectionChanged.emit($event.value)"
          >
            <mat-option
              *ngFor="
                let name of indices[
                  deviceSelect.selectedOptions.selected[0]?.value
                ]
              "
              [value]="name"
            >
              {{ name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </ng-container>
  </mat-card-content>
</mat-card>
